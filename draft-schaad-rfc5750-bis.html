<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Secure/Multipurpose Internet Mail Extensions (S/ MIME) Version 3.2 Certificate Handling</title>

  <style type="text/css">/*<![CDATA[*/
@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}

@media screen and (min-width: 1024px) {
  ul.toc, #rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    padding: 0 1em;
    z-index: 1;
  }
  #rfc\.toc {
    top: 16px;
  }
  ul.toc {
    top: 80px;
    overflow: auto;
  }

  body {
    padding-left: 1.5em;
    padding-right: 29em;
  }
}

body {
  font: 15px "Helvetica Neue",Helvetica,Arial,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 130%;
  margin: 2.5em auto;
  max-width: 724px;
}

.title, .filename, h1, h2, h3, h4 {
  font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
  font-size-adjust: 0.5;
  font-weight: 500;
  color: #333;
  line-height: 100%;
  margin: 0.8em 0 0.3em;
}
.title { font-size: 36px; }
h1 { font-size: 30px; }
h2 { font-size: 24px; }
h3, h4 { font-size: 18px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

ul.toc li {
  list-style: none;
  text-indent: -2.5em;
  padding-left: 2.5em;
  padding-bottom: 5px;
  margin: 0;
}
ul.toc, ul.toc ul {
  margin: 0 0 0 1.5em;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header {
  width: 100%;
}
table.header td {
  border: none;
  background-color: transparent;
  color: black;
}
.filename {
  color: rgb(119, 119, 119);
  font-size: 23px;
  font-weight: normal;
  height: auto;
  line-height: 100%;
}
#rfc\.abstract+p {
  font-size: 20px;
  font-weight: 300;
  line-height: 130%;
}

samp, tt, code, pre {
  font: 11pt consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure {
  font-style: italic;
  margin: 0 1.5em;
}

address {
  margin: 10px 0 0;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn {
  font-weight: bold;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

ol, ul, li, p {
  padding: 0;
  margin: 0.5em 0 0.5em 2em;
}
li, p {
  margin-left: 0;
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
  /*]]>*/</style>

  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction"/>
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Definitions"/>
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Conventions Used in This Document"/>
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 Compatibility with Prior Practice S/MIME"/>
<link href="#rfc.section.1.4" rel="Chapter" title="1.4 Changes from S/MIME v3 to S/MIME v3.1"/>
<link href="#rfc.section.1.5" rel="Chapter" title="1.5 Changes since S/MIME v3.1"/>
<link href="#rfc.section.2" rel="Chapter" title="2 CMS Options"/>
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Certificate Revocation Lists"/>
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Certificate Choices"/>
<link href="#rfc.section.2.2.1" rel="Chapter" title="2.2.1 Historical Note about CMS Certificates"/>
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 CertificateSet"/>
<link href="#rfc.section.3" rel="Chapter" title="3 Using Distinguished Names for Internet Mail"/>
<link href="#rfc.section.4" rel="Chapter" title="4 Certificate Processing"/>
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Certificate Revocation Lists"/>
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Certificate Path Validation"/>
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Certificate and CRL Signing Algorithms and Key Sizes"/>
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 PKIX Certificate Extensions"/>
<link href="#rfc.section.4.4.1" rel="Chapter" title="4.4.1 Basic Constraints"/>
<link href="#rfc.section.4.4.2" rel="Chapter" title="4.4.2 Key Usage Certificate Extension"/>
<link href="#rfc.section.4.4.3" rel="Chapter" title="4.4.3 Subject Alternative Name"/>
<link href="#rfc.section.4.4.4" rel="Chapter" title="4.4.4 Extended Key Usage Extension"/>
<link href="#rfc.section.5" rel="Chapter" title="5 Security Considerations"/>
<link href="#rfc.references" rel="Chapter" title="6 References"/>
<link href="#rfc.references.1" rel="Chapter" title="6.1 Normative References"/>
<link href="#rfc.references.2" rel="Chapter" title="6.2 Informational References"/>
<link href="#rfc.appendix.A" rel="Chapter" title="A Moving S/MIME v2 Certificate Handling to Historic Status"/>
<link href="#rfc.appendix.B" rel="Chapter" title="B Acknowledgments"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.5.1 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Schaad, J., Ramsdell, B., and S. Turner" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-schaad-rfc5750-bis-latest" />
  <meta name="dct.issued" scheme="ISO8601" content="2016-7-21" />
  <meta name="dct.abstract" content="This document specifies conventions for X.509 certificate usage by Secure/Multipurpose Internet Mail Extensions (S/&#8288;MIME) v3.2 agents.  S/&#8288;MIME provides a method to send and receive secure MIME messages, and certificates are an integral part of S/&#8288;MIME agent processing.  S/&#8288;MIME agents validate certificates as described in RFC 5280, the Internet X.509 Public Key Infrastructure Certificate and CRL Profile.  S/&#8288;MIME agents must meet the certificate processing requirements in this document as well as those in RFC 5280.  This document obsoletes RFC 3850.  " />
  <meta name="description" content="This document specifies conventions for X.509 certificate usage by Secure/Multipurpose Internet Mail Extensions (S/&#8288;MIME) v3.2 agents.  S/&#8288;MIME provides a method to send and receive secure MIME messages, and certificates are an integral part of S/&#8288;MIME agent processing.  S/&#8288;MIME agents validate certificates as described in RFC 5280, the Internet X.509 Public Key Infrastructure Certificate and CRL Profile.  S/&#8288;MIME agents must meet the certificate processing requirements in this document as well as those in RFC 5280.  This document obsoletes RFC 3850.  " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left">SPASM</td>
  <td class="right">J. Schaad</td>
</tr>
<tr>
  <td class="left">Internet-Draft</td>
  <td class="right">August Cellars</td>
</tr>
<tr>
  <td class="left">Intended status: Standards Track</td>
  <td class="right">B. Ramsdell</td>
</tr>
<tr>
  <td class="left">Expires: January 22, 2017</td>
  <td class="right">Brute Squad Labs, Inc.</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">S. Turner</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">sn3rd</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">July 21, 2016</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Secure/Multipurpose Internet Mail Extensions (S/ MIME) Version 3.2 Certificate Handling<br />
  <span class="filename">draft-schaad-rfc5750-bis-latest</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>This document specifies conventions for X.509 certificate usage by Secure/Multipurpose Internet Mail Extensions (S/&#8288;MIME) v3.2 agents.  S/&#8288;MIME provides a method to send and receive secure MIME messages, and certificates are an integral part of S/&#8288;MIME agent processing.  S/&#8288;MIME agents validate certificates as described in RFC 5280, the Internet X.509 Public Key Infrastructure Certificate and CRL Profile.  S/&#8288;MIME agents must meet the certificate processing requirements in this document as well as those in RFC 5280.  This document obsoletes RFC 3850.  </p>
<h1>
  <a>Contributing to this document</a>
</h1>
<p>The source for this draft is being maintained in GitHub.  Suggested changes should be submitted as pull requests  at <span>&lt;</span><a href="https://github.com/spasm-wg/smime">https://github.com/spasm-wg/smime</a><span>&gt;</span>.  Instructions are on that page as well.  Editorial changes can be managed in GitHub, but any substantial issues need to be discussed on the SPASM mailing list.  </p>
<h1 id="rfc.status">
  <a href="#rfc.status">Status of This Memo</a>
</h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on January 22, 2017.</p>
<h1 id="rfc.copyrightnotice">
  <a href="#rfc.copyrightnotice">Copyright Notice</a>
</h1>
<p>Copyright (c) 2016 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a></li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Definitions</a></li>
<li>1.2.   <a href="#rfc.section.1.2">Conventions Used in This Document</a></li>
<li>1.3.   <a href="#rfc.section.1.3">Compatibility with Prior Practice S/MIME</a></li>
<li>1.4.   <a href="#rfc.section.1.4">Changes from S/MIME v3 to S/MIME v3.1</a></li>
<li>1.5.   <a href="#rfc.section.1.5">Changes since S/MIME v3.1</a></li>
</ul><li>2.   <a href="#rfc.section.2">CMS Options</a></li>
<ul><li>2.1.   <a href="#rfc.section.2.1">Certificate Revocation Lists</a></li>
<li>2.2.   <a href="#rfc.section.2.2">Certificate Choices</a></li>
<ul><li>2.2.1.   <a href="#rfc.section.2.2.1">Historical Note about CMS Certificates</a></li>
</ul><li>2.3.   <a href="#rfc.section.2.3">CertificateSet</a></li>
</ul><li>3.   <a href="#rfc.section.3">Using Distinguished Names for Internet Mail</a></li>
<li>4.   <a href="#rfc.section.4">Certificate Processing</a></li>
<ul><li>4.1.   <a href="#rfc.section.4.1">Certificate Revocation Lists</a></li>
<li>4.2.   <a href="#rfc.section.4.2">Certificate Path Validation</a></li>
<li>4.3.   <a href="#rfc.section.4.3">Certificate and CRL Signing Algorithms and Key Sizes</a></li>
<li>4.4.   <a href="#rfc.section.4.4">PKIX Certificate Extensions</a></li>
<ul><li>4.4.1.   <a href="#rfc.section.4.4.1">Basic Constraints</a></li>
<li>4.4.2.   <a href="#rfc.section.4.4.2">Key Usage Certificate Extension</a></li>
<li>4.4.3.   <a href="#rfc.section.4.4.3">Subject Alternative Name</a></li>
<li>4.4.4.   <a href="#rfc.section.4.4.4">Extended Key Usage Extension</a></li>
</ul></ul><li>5.   <a href="#rfc.section.5">Security Considerations</a></li>
<li>6.   <a href="#rfc.references">References</a></li>
<ul><li>6.1.   <a href="#rfc.references.1">Normative References</a></li>
<li>6.2.   <a href="#rfc.references.2">Informational References</a></li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">Moving S/MIME v2 Certificate Handling to Historic Status</a></li>
<li>Appendix B.   <a href="#rfc.appendix.B">Acknowledgments</a></li>
<li><a href="#rfc.authors">Authors' Addresses</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">S/&#8288;MIME (Secure/Multipurpose Internet Mail Extensions) v3.2, described in <a href="#RFC5751">[RFC5751]</a>, provides a method to send and receive secure MIME messages.  Before using a public key to provide security services, the S/&#8288;MIME agent MUST verify that the public key is valid.  S/&#8288;MIME agents MUST use PKIX certificates to validate public keys as described in the Internet X.509 Public Key Infrastructure (PKIX) Certificate and CRL Profile <a href="#RFC5280">[RFC5280]</a>.  S/&#8288;MIME agents MUST meet the certificate processing requirements documented in this document in addition to those stated in <a href="#RFC5280">[RFC5280]</a>.  </p>
<p id="rfc.section.1.p.2">This specification is compatible with the Cryptographic Message Syntax (CMS) RFC 5652 <a href="#RFC5652">[RFC5652]</a> in that it uses the data types defined by CMS.  It also inherits all the varieties of architectures for certificate-based key management supported by CMS.  </p>
<h1 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a> Definitions</h1>
<p id="rfc.section.1.1.p.1">For the purposes of this document, the following definitions apply.  </p>
<p id="rfc.section.1.1.p.2">ASN.1: Abstract Syntax Notation One, as defined in ITU-T X.680 <a href="#X.680">[X.680]</a>.  </p>
<p id="rfc.section.1.1.p.3">Attribute certificate (AC): An X.509 AC is a separate structure from a subject's public key X.509 certificate.  A subject may have multiple X.509 ACs associated with each of its public key X.509 certificates.  Each X.509 AC binds one or more attributes with one of the subject's public key X.509 certificates.  The X.509 AC syntax is defined in <a href="#RFC5755">[RFC5755]</a>.  </p>
<p id="rfc.section.1.1.p.4">Certificate: A type that binds an entity's name to a public key with a digital signature.  This type is defined in the Internet X.509 Public Key Infrastructure (PKIX) Certificate and CRL Profile <a href="#RFC5280">[RFC5280]</a>.  This type also contains the distinguished name of the certificate issuer (the signer), an issuer-specific serial number, the issuer's signature algorithm identifier, a validity period, and extensions also defined in that document.  </p>
<p id="rfc.section.1.1.p.5">Certificate Revocation List (CRL): A type that contains information about certificates whose validity an issuer has prematurely revoked.  The information consists of an issuer name, the time of issue, the next scheduled time of issue, a list of certificate serial numbers and their associated revocation times, and extensions as defined in <a href="#RFC5280">[RFC5280]</a>.  The CRL is signed by the issuer.  The type intended by this specification is the one defined in <a href="#RFC5280">[RFC5280]</a>.  </p>
<p id="rfc.section.1.1.p.6">Receiving agent: Software that interprets and processes S/&#8288;MIME CMS objects, MIME body parts that contain CMS objects, or both.  </p>
<p id="rfc.section.1.1.p.7">Sending agent: Software that creates S/&#8288;MIME CMS objects, MIME body parts that contain CMS objects, or both.  </p>
<p id="rfc.section.1.1.p.8">S/&#8288;MIME agent: User software that is a receiving agent, a sending agent, or both.  </p>
<h1 id="rfc.section.1.2"><a href="#rfc.section.1.2">1.2.</a> Conventions Used in This Document</h1>
<p id="rfc.section.1.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.  </p>
<p id="rfc.section.1.2.p.2">We define some additional terms here: </p>

<dl>
  <dt>SHOULD+</dt>
  <dd style="margin-left: 8">This term means the same as SHOULD.  However, the authors expect that a requirement marked as SHOULD+ will be promoted at some future time to be a MUST.  </dd>
  <dt>SHOULD-</dt>
  <dd style="margin-left: 8">This term means the same as SHOULD.  However, the authors expect that a requirement marked as SHOULD- will be demoted to a MAY in a future version of this document.  </dd>
  <dt>MUST-</dt>
  <dd style="margin-left: 8">This term means the same as MUST.  However, the authors expect that this requirement will no longer be a MUST in a future document.  Although its status will be determined at a later time, it is reasonable to expect that if a future revision of a document alters the status of a MUST- requirement, it will remain at least a SHOULD or a SHOULD-.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.1.3"><a href="#rfc.section.1.3">1.3.</a> Compatibility with Prior Practice S/MIME</h1>
<p id="rfc.section.1.3.p.1">S/&#8288;MIME version 3.2 agents ought to attempt to have the greatest interoperability possible with agents for prior versions of S/&#8288;MIME.  </p>
<p id="rfc.section.1.3.p.2">S/&#8288;MIME version 2 is described in RFC 2311 through RFC 2315 inclusive <a href="#SMIMEv2">[SMIMEv2]</a>, S/&#8288;MIME version 3 is described in RFC 2630 through RFC 2634 inclusive and RFC 5035 <a href="#SMIMEv3">[SMIMEv3]</a>, and S/&#8288;MIME version 3.1 is described in RFC 3850, RFC 3851, RFC 3852, RFC 2634, and RFC 5035 <a href="#SMIMEv3.1">[SMIMEv3.1]</a>.  RFC 2311 also has historical information about the development of S/&#8288;MIME.  </p>
<h1 id="rfc.section.1.4"><a href="#rfc.section.1.4">1.4.</a> Changes from S/MIME v3 to S/MIME v3.1</h1>
<p id="rfc.section.1.4.p.1">Version 1 and version 2 CRLs MUST be supported.  </p>
<p id="rfc.section.1.4.p.2">Multiple certification authority (CA) certificates with the same subject and public key, but with overlapping validity periods, MUST be supported.  </p>
<p id="rfc.section.1.4.p.3">Version 2 attribute certificates SHOULD be supported, and version 1 attributes certificates MUST NOT be used.  </p>
<p id="rfc.section.1.4.p.4">The use of the MD2 digest algorithm for certificate signatures is discouraged, and security language was added.  </p>
<p id="rfc.section.1.4.p.5">Clarified use of email address use in certificates.  Certificates that do not contain an email address have no requirements for verifying the email address associated with the certificate.  </p>
<p id="rfc.section.1.4.p.6">Receiving agents SHOULD display certificate information when displaying the results of signature verification.  </p>
<p id="rfc.section.1.4.p.7">Receiving agents MUST NOT accept a signature made with a certificate that does not have the digitalSignature or nonRepudiation bit set.  </p>
<p id="rfc.section.1.4.p.8">Clarifications for the interpretation of the key usage and extended key usage extensions.  </p>
<h1 id="rfc.section.1.5"><a href="#rfc.section.1.5">1.5.</a> Changes since S/MIME v3.1</h1>
<p id="rfc.section.1.5.p.1">Conventions Used in This Document: Moved to Section 1.2. Added definitions for SHOULD+, SHOULD-, and MUST-.  </p>

<dl>
  <dt>Section 1.1:</dt>
  <dd style="margin-left: 12">Updated ASN.1 definition and reference.</dd>
  <dt>Section 1.3:</dt>
  <dd style="margin-left: 12">Added text about v3.1 RFCs.</dd>
  <dt>Section 3:</dt>
  <dd style="margin-left: 12">Aligned email address text with RFC 5280.  Updated note to indicate emailAddress IA5String upper bound is 255 characters.  Added text about matching email addresses.  </dd>
  <dt>Section 4.2:</dt>
  <dd style="margin-left: 12">Added text to indicate how S/&#8288;MIME agents locate the correct user certificate.  </dd>
  <dt>Section 4.3:</dt>
  <dd style="margin-left: 12">RSA with SHA-256 (PKCS #1 v1.5) added as MUST; DSA with SHA-256 added as SHOULD+; RSA with SHA-1, DSA with SHA-1, and RSA with MD5 changed to SHOULD-; and RSASSA-PSS with SHA-256 added as SHOULD+.  Updated key sizes and changed pointer to PKIX RFCs.  </dd>
  <dt>Section 4.4.1:</dt>
  <dd style="margin-left: 12">Aligned with PKIX on use of basic constraints extension in CA certificates.  Clarified which extension is used to constrain end entities from using their keys to perform issuing authority operations.  </dd>
  <dt>Section 5:</dt>
  <dd style="margin-left: 12">Updated security considerations.</dd>
  <dt>Section 7:</dt>
  <dd style="margin-left: 12">Moved references from Appendix B to Section 6.  Updated the references.  </dd>
  <dt>Appendix A:</dt>
  <dd style="margin-left: 12">Moved Appendix A to Appendix B.  Added Appendix A to move S/&#8288;MIME v2 Certificate Handling to Historic Status.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> CMS Options</h1>
<p id="rfc.section.2.p.1">The CMS message format allows for a wide variety of options in content and algorithm support.  This section puts forth a number of support requirements and recommendations in order to achieve a base level of interoperability among all S/&#8288;MIME implementations.  Most of the CMS format for S/&#8288;MIME messages is defined in <a href="#RFC5751">[RFC5751]</a>.  </p>
<h1 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1.</a> Certificate Revocation Lists</h1>
<p id="rfc.section.2.1.p.1">Receiving agents MUST support the Certificate Revocation List (CRL) format defined in <a href="#RFC5280">[RFC5280]</a>.  If sending agents include CRLs in outgoing messages, the CRL format defined in <a href="#RFC5280">[RFC5280]</a> MUST be used.  In all cases, both v1 and v2 CRLs MUST be supported.  </p>
<p id="rfc.section.2.1.p.2">All agents MUST be capable of performing revocation checks using CRLs as specified in <a href="#RFC5280">[RFC5280]</a>.  All agents MUST perform revocation status checking in accordance with <a href="#RFC5280">[RFC5280]</a>.  Receiving agents MUST recognize CRLs in received S/&#8288;MIME messages.  </p>
<p id="rfc.section.2.1.p.3">Agents SHOULD store CRLs received in messages for use in processing later messages.  </p>
<h1 id="rfc.section.2.2"><a href="#rfc.section.2.2">2.2.</a> Certificate Choices</h1>
<p id="rfc.section.2.2.p.1">Receiving agents MUST support v1 X.509 and v3 X.509 certificates as profiled in <a href="#RFC5280">[RFC5280]</a>.  End-entity certificates MAY include an Internet mail address, as described in Section 3.  </p>
<p id="rfc.section.2.2.p.2">Receiving agents SHOULD support X.509 version 2 attribute certificates.  See <a href="#RFC5755">[RFC5755]</a> for details about the profile for attribute certificates.  </p>
<h1 id="rfc.section.2.2.1"><a href="#rfc.section.2.2.1">2.2.1.</a> Historical Note about CMS Certificates</h1>
<p id="rfc.section.2.2.1.p.1">The CMS message format supports a choice of certificate formats for public key content types: PKIX, PKCS #6 extended certificates <a href="#PKCS6">[PKCS6]</a>, and PKIX attribute certificates.  </p>
<p id="rfc.section.2.2.1.p.2">The PKCS #6 format is not in widespread use.  In addition, PKIX certificate extensions address much of the same functionality and flexibility as was intended in the PKCS #6.  Thus, sending and receiving agents MUST NOT use PKCS #6 extended certificates.  </p>
<p id="rfc.section.2.2.1.p.3">X.509 version 1 attribute certificates are also not widely implemented, and have been superseded with version 2 attribute certificates.  Sending agents MUST NOT send version 1 attribute certificates.  </p>
<h1 id="rfc.section.2.3"><a href="#rfc.section.2.3">2.3.</a> CertificateSet</h1>
<p id="rfc.section.2.3.p.1">Receiving agents MUST be able to handle an arbitrary number of certificates of arbitrary relationship to the message sender and to each other in arbitrary order.  In many cases, the certificates included in a signed message may represent a chain of certification from the sender to a particular root.  There may be, however, situations where the certificates in a signed message may be unrelated and included for convenience.  </p>
<p id="rfc.section.2.3.p.2">Sending agents SHOULD include any certificates for the user's public key(s) and associated issuer certificates.  This increases the likelihood that the intended recipient can establish trust in the originator's public key(s).  This is especially important when sending a message to recipients that may not have access to the sender's public key through any other means or when sending a signed message to a new recipient.  The inclusion of certificates in outgoing messages can be omitted if S/&#8288;MIME objects are sent within a group of correspondents that has established access to each other's certificates by some other means such as a shared directory or manual certificate distribution.  Receiving S/&#8288;MIME agents SHOULD be able to handle messages without certificates using a database or directory lookup scheme.  </p>
<p id="rfc.section.2.3.p.3">A sending agent SHOULD include at least one chain of certificates up to, but not including, a certification authority (CA) that it believes that the recipient may trust as authoritative.  A receiving agent MUST be able to handle an arbitrarily large number of certificates and chains.  </p>
<p id="rfc.section.2.3.p.4">Agents MAY send CA certificates, that is, cross-certificates, self- issued certificates, and self-signed certificates.  Note that receiving agents SHOULD NOT simply trust any self-signed certificates as valid CAs, but SHOULD use some other mechanism to determine if this is a CA that should be trusted.  Also note that when certificates contain Digital Signature Algorithm (DSA) public keys the parameters may be located in the root certificate.  This would require that the recipient possess both the end-entity certificate and the root certificate to perform a signature verification, and is a valid example of a case where transmitting the root certificate may be required.  </p>
<p id="rfc.section.2.3.p.5">Receiving agents MUST support chaining based on the distinguished name fields.  Other methods of building certificate chains MAY be supported.  </p>
<p id="rfc.section.2.3.p.6">Receiving agents SHOULD support the decoding of X.509 attribute certificates included in CMS objects.  All other issues regarding the generation and use of X.509 attribute certificates are outside of the scope of this specification.  One specification that addresses attribute certificate use is defined in <a href="#RFC3114">[RFC3114]</a>.  </p>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> Using Distinguished Names for Internet Mail</h1>
<p id="rfc.section.3.p.1">End-entity certificates MAY contain an Internet mail address as described in <a href="#RFC5280">[RFC5280]</a>, Section 4.2.1.6.  The email address SHOULD be in the subjectAltName extension, and SHOULD NOT be in the subject distinguished name.  </p>
<p id="rfc.section.3.p.2">Receiving agents MUST recognize and accept certificates that contain no email address.  Agents are allowed to provide an alternative mechanism for associating an email address with a certificate that does not contain an email address, such as through the use of the agent's address book, if available.  Receiving agents MUST recognize email addresses in the subjectAltName field.  Receiving agents MUST recognize email addresses in the Distinguished Name field in the PKCS #9 <a href="#RFC2985">[RFC2985]</a> emailAddress attribute: </p>
<pre>
pkcs-9-at-emailAddress OBJECT IDENTIFIER ::=
 { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9) 1 }
      </pre>
<p id="rfc.section.3.p.3">Note that this attribute MUST be encoded as IA5String and has an upper bound of 255 characters.  The right side of the email address SHOULD be treated as ASCII-case-insensitive.  </p>
<p id="rfc.section.3.p.4">Sending agents SHOULD make the address in the From or Sender header in a mail message match an Internet mail address in the signer's certificate.  Receiving agents MUST check that the address in the From or Sender header of a mail message matches an Internet mail address, if present, in the signer's certificate, if mail addresses are present in the certificate.  A receiving agent SHOULD provide some explicit alternate processing of the message if this comparison fails, which may be to display a message that shows the recipient the addresses in the certificate or other certificate details.  </p>
<p id="rfc.section.3.p.5">A receiving agent SHOULD display a subject name or other certificate details when displaying an indication of successful or unsuccessful signature verification.  </p>
<p id="rfc.section.3.p.6">All subject and issuer names MUST be populated (i.e., not an empty SEQUENCE) in S/&#8288;MIME-compliant X.509 certificates, except that the subject distinguished name (DN) in a user's (i.e., end-entity) certificate MAY be an empty SEQUENCE in which case the subjectAltName extension will include the subject's identifier and MUST be marked as critical.  </p>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> Certificate Processing</h1>
<p id="rfc.section.4.p.1">S/&#8288;MIME agents need to provide some certificate retrieval mechanism in order to gain access to certificates for recipients of digital envelopes.  There are many ways to implement certificate retrieval mechanisms.  <a href="#X.500">[X.500]</a> directory service is an excellent example of a certificate retrieval-only mechanism that is compatible with classic X.500 Distinguished Names.  Another method under consideration by the IETF is to provide certificate retrieval services as part of the existing Domain Name System (DNS).  Until such mechanisms are widely used, their utility may be limited by the small number of the correspondent's certificates that can be retrieved.  At a minimum, for initial S/&#8288;MIME deployment, a user agent could automatically generate a message to an intended recipient requesting the recipient's certificate in a signed return message.  </p>
<p id="rfc.section.4.p.2">Receiving and sending agents SHOULD also provide a mechanism to allow a user to "store and protect" certificates for correspondents in such a way so as to guarantee their later retrieval.  In many environments, it may be desirable to link the certificate retrieval/storage mechanisms together in some sort of certificate database.  In its simplest form, a certificate database would be local to a particular user and would function in a similar way as an "address book" that stores a user's frequent correspondents.  In this way, the certificate retrieval mechanism would be limited to the certificates that a user has stored (presumably from incoming messages).  A comprehensive certificate retrieval/storage solution may combine two or more mechanisms to allow the greatest flexibility and utility to the user.  For instance, a secure Internet mail agent may resort to checking a centralized certificate retrieval mechanism for a certificate if it cannot be found in a user's local certificate storage/retrieval database.  </p>
<p id="rfc.section.4.p.3">Receiving and sending agents SHOULD provide a mechanism for the import and export of certificates, using a CMS certs-only message.  This allows for import and export of full certificate chains as opposed to just a single certificate.  This is described in <a href="#RFC5751">[RFC5751]</a>.  </p>
<p id="rfc.section.4.p.4">Agents MUST handle multiple valid certification authority (CA) certificates containing the same subject name and the same public keys but with overlapping validity intervals.  </p>
<h1 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1.</a> Certificate Revocation Lists</h1>
<p id="rfc.section.4.1.p.1">In general, it is always better to get the latest CRL information from a CA than to get information stored away from incoming messages.  A receiving agent SHOULD have access to some CRL retrieval mechanism in order to gain access to certificate revocation information when validating certification paths.  A receiving or sending agent SHOULD also provide a mechanism to allow a user to store incoming certificate revocation information for correspondents in such a way so as to guarantee its later retrieval.  </p>
<p id="rfc.section.4.1.p.2">Receiving and sending agents SHOULD retrieve and utilize CRL information every time a certificate is verified as part of a certification path validation even if the certificate was already verified in the past.  However, in many instances (such as off-line verification) access to the latest CRL information may be difficult or impossible.  The use of CRL information, therefore, may be dictated by the value of the information that is protected.  The value of the CRL information in a particular context is beyond the scope of this specification but may be governed by the policies associated with particular certification paths.  </p>
<p id="rfc.section.4.1.p.3">All agents MUST be capable of performing revocation checks using CRLs as specified in <a href="#RFC5280">[RFC5280]</a>.  All agents MUST perform revocation status checking in accordance with <a href="#RFC5280">[RFC5280]</a>.  Receiving agents MUST recognize CRLs in received S/&#8288;MIME messages.  </p>
<h1 id="rfc.section.4.2"><a href="#rfc.section.4.2">4.2.</a> Certificate Path Validation</h1>
<p id="rfc.section.4.2.p.1">In creating a user agent for secure messaging, certificate, CRL, and certification path validation SHOULD be highly automated while still acting in the best interests of the user.  Certificate, CRL, and path validation MUST be performed as per <a href="#RFC5280">[RFC5280]</a> when validating a correspondent's public key.  This is necessary before using a public key to provide security services such as verifying a signature, encrypting a content-encryption key (e.g., RSA), or forming a pairwise symmetric key (e.g., Diffie-Hellman) to be used to encrypt or decrypt a content-encryption key.  </p>
<p id="rfc.section.4.2.p.2">Certificates and CRLs are made available to the path validation procedure in two ways: a) incoming messages, and b) certificate and CRL retrieval mechanisms.  Certificates and CRLs in incoming messages are not required to be in any particular order nor are they required to be in any way related to the sender or recipient of the message (although in most cases they will be related to the sender).  Incoming certificates and CRLs SHOULD be cached for use in path validation and optionally stored for later use.  This temporary certificate and CRL cache SHOULD be used to augment any other certificate and CRL retrieval mechanisms for path validation on incoming signed messages.  </p>
<p id="rfc.section.4.2.p.3">When verifying a signature and the certificates that are included in the message, if a signingCertificate attribute from RFC 2634 <a href="#ESS">[ESS]</a> or a signingCertificateV2 attribute from RFC 5035 <a href="#ESS">[ESS]</a> is found in an S/&#8288;MIME message, it SHALL be used to identify the signer's certificate.  Otherwise, the certificate is identified in an S/&#8288;MIME message, either using the issuerAndSerialNumber, which identifies the signer's certificate by the issuer's distinguished name and the certificate serial number, or the subjectKeyIdentifier, which identifies the signer's certificate by a key identifier.  </p>
<p id="rfc.section.4.2.p.4">When decrypting an encrypted message, if a SMIMEEncryptionKeyPreference attribute is found in an encapsulating SignedData, it SHALL be used to identify the originator's certificate found in OriginatorInfo.  See <a href="#RFC5652">[RFC5652]</a> for the CMS fields that reference the originator's and recipient's certificates.  </p>
<h1 id="rfc.section.4.3"><a href="#rfc.section.4.3">4.3.</a> Certificate and CRL Signing Algorithms and Key Sizes</h1>
<p id="rfc.section.4.3.p.1">Certificates and Certificate Revocation Lists (CRLs) are signed by the certificate issuer.  Receiving agents: </p>

<ul>
  <li>MUST support RSA with SHA-256</li>
  <li>SHOULD+ support DSA with SHA-256</li>
  <li>SHOULD+ support RSASSA-PSS with SHA-256</li>
  <li>SHOULD- support RSA with SHA-1</li>
  <li>SHOULD- support DSA with SHA-1</li>
  <li>SHOULD- support RSA with MD5</li>
</ul>

<p> </p>
<p id="rfc.section.4.3.p.2">The following are the RSA and RSASSA-PSS key size requirements for S/&#8288;MIME receiving agents during certificate and CRL signature verification: </p>
<pre>
           key size &lt;= 1023 : MAY  (see Section 5)
   1024 &lt;= key size &lt;= 4096 : MUST (see Section 5)
   4096 &lt;  key size         : MAY  (see Section 5)
    </pre>
<p id="rfc.section.4.3.p.3">The following are the DSA key size requirements for S/&#8288;MIME receiving agents during certificate and CRL signature verification: </p>
<pre>
            key size &lt;= 1023 : MAY  (see Section 5)
    1024 &lt;= key size &lt;= 3072 : MUST (see Section 5)
    </pre>
<p id="rfc.section.4.3.p.4">For 512-bit RSA with SHA-1 see <a href="#RFC3279">[RFC3279]</a> and <a href="#FIPS186-2">[FIPS186-2]</a> without Change Notice 1, for 512-bit RSA with SHA-256 see <a href="#RFC4055">[RFC4055]</a> and <a href="#FIPS186-2">[FIPS186-2]</a> without Change Notice 1, for 1024-bit through 3072-bit RSA with SHA-256 see <a href="#RFC4055">[RFC4055]</a> and <a href="#FIPS186-2">[FIPS186-2]</a> with Change Notice 1, and for 4096-bit RSA with SHA-256 see <a href="#RFC4055">[RFC4055]</a> and <a href="#RFC3447">[RFC3447]</a>.  In either case, the first reference provides the signature algorithm's object identifier and the second provides the signature algorithm's definition.  </p>
<p id="rfc.section.4.3.p.5">For 512-bit DSA with SHA-1 see <a href="#RFC3279">[RFC3279]</a> and <a href="#FIPS186-2">[FIPS186-2]</a> without Change Notice 1, for 512-bit DSA with SHA-256 see <a href="#RFC5758">[RFC5758]</a> and <a href="#FIPS186-2">[FIPS186-2]</a> without Change Notice 1, for 1024-bit DSA with SHA-1 see <a href="#RFC3279">[RFC3279]</a> and <a href="#FIPS186-2">[FIPS186-2]</a> with Change Notice 1, for 1024-bit through 3072 DSA with SHA-256 see <a href="#RFC5758">[RFC5758]</a> and <a href="#FIPS186-3">[FIPS186-3]</a>.  In either case, the first reference provides the signature algorithm's object identifier and the second provides the signature algorithm's definition.  </p>
<p id="rfc.section.4.3.p.6">For RSASSA-PSS with SHA-256 see <a href="#RFC4056">[RFC4056]</a>.  </p>
<h1 id="rfc.section.4.4"><a href="#rfc.section.4.4">4.4.</a> PKIX Certificate Extensions</h1>
<p id="rfc.section.4.4.p.1">PKIX describes an extensible framework in which the basic certificate information can be extended and describes how such extensions can be used to control the process of issuing and validating certificates.  The PKIX Working Group has ongoing efforts to identify and create extensions that have value in particular certification environments.  Further, there are active efforts underway to issue PKIX certificates for business purposes.  This document identifies the minimum required set of certificate extensions that have the greatest value in the S/&#8288;MIME environment.  The syntax and semantics of all the identified extensions are defined in <a href="#RFC5280">[RFC5280]</a>.  </p>
<p id="rfc.section.4.4.p.2">Sending and receiving agents MUST correctly handle the basic constraints, key usage, authority key identifier, subject key identifier, and subject alternative names certificate extensions when they appear in end-entity and CA certificates.  Some mechanism SHOULD exist to gracefully handle other certificate extensions when they appear in end-entity or CA certificates.  </p>
<p id="rfc.section.4.4.p.3">Certificates issued for the S/&#8288;MIME environment SHOULD NOT contain any critical extensions (extensions that have the critical field set to TRUE) other than those listed here.  These extensions SHOULD be marked as non-critical unless the proper handling of the extension is deemed critical to the correct interpretation of the associated certificate.  Other extensions may be included, but those extensions SHOULD NOT be marked as critical.  </p>
<p id="rfc.section.4.4.p.4">Interpretation and syntax for all extensions MUST follow <a href="#RFC5280">[RFC5280]</a>, unless otherwise specified here.  </p>
<h1 id="rfc.section.4.4.1"><a href="#rfc.section.4.4.1">4.4.1.</a> Basic Constraints</h1>
<p id="rfc.section.4.4.1.p.1">The basic constraints extension serves to delimit the role and position that an issuing authority or end-entity certificate plays in a certification path.  </p>
<p id="rfc.section.4.4.1.p.2">For example, certificates issued to CAs and subordinate CAs contain a basic constraint extension that identifies them as issuing authority certificates.  End-entity certificates contain the key usage extension that restrains end entities from using the key when performing issuing authority operations (see Section 4.4.2).  </p>
<p id="rfc.section.4.4.1.p.3">As per <a href="#RFC5280">[RFC5280]</a>, certificates MUST contain a basicConstraints extension in CA certificates, and SHOULD NOT contain that extension in end- entity certificates.  </p>
<h1 id="rfc.section.4.4.2"><a href="#rfc.section.4.4.2">4.4.2.</a> Key Usage Certificate Extension</h1>
<p id="rfc.section.4.4.2.p.1">The key usage extension serves to limit the technical purposes for which a public key listed in a valid certificate may be used.  Issuing authority certificates may contain a key usage extension that restricts the key to signing certificates, certificate revocation lists, and other data.  </p>
<p id="rfc.section.4.4.2.p.2">For example, a certification authority may create subordinate issuer certificates that contain a key usage extension that specifies that the corresponding public key can be used to sign end user certificates and sign CRLs.  </p>
<p id="rfc.section.4.4.2.p.3">If a key usage extension is included in a PKIX certificate, then it MUST be marked as critical.  </p>
<p id="rfc.section.4.4.2.p.4">S/&#8288;MIME receiving agents MUST NOT accept the signature of a message if it was verified using a certificate that contains the key usage extension without either the digitalSignature or nonRepudiation bit set.  Sometimes S/&#8288;MIME is used as a secure message transport for applications beyond interpersonal messaging.  In such cases, the S/&#8288;MIME-enabled application can specify additional requirements concerning the digitalSignature or nonRepudiation bits within this extension.  </p>
<p id="rfc.section.4.4.2.p.5">If the key usage extension is not specified, receiving clients MUST presume that the digitalSignature and nonRepudiation bits are set.  </p>
<h1 id="rfc.section.4.4.3"><a href="#rfc.section.4.4.3">4.4.3.</a> Subject Alternative Name</h1>
<p id="rfc.section.4.4.3.p.1">The subject alternative name extension is used in S/&#8288;MIME as the preferred means to convey the email address(es) that correspond(s) to the entity for this certificate.  Any email addresses present MUST be encoded using the rfc822Name CHOICE of the GeneralName type as described in <a href="#RFC5280">[RFC5280]</a>, Section 4.2.1.6.  Since the SubjectAltName type is a SEQUENCE OF GeneralName, multiple email addresses MAY be present.  </p>
<h1 id="rfc.section.4.4.4"><a href="#rfc.section.4.4.4">4.4.4.</a> Extended Key Usage Extension</h1>
<p id="rfc.section.4.4.4.p.1">The extended key usage extension also serves to limit the technical purposes for which a public key listed in a valid certificate may be used.  The set of technical purposes for the certificate therefore are the intersection of the uses indicated in the key usage and extended key usage extensions.  </p>
<p id="rfc.section.4.4.4.p.2">For example, if the certificate contains a key usage extension indicating digital signature and an extended key usage extension that includes the email protection OID, then the certificate may be used for signing but not encrypting S/&#8288;MIME messages.  If the certificate contains a key usage extension indicating digital signature but no extended key usage extension, then the certificate may also be used to sign but not encrypt S/&#8288;MIME messages.  </p>
<p id="rfc.section.4.4.4.p.3">If the extended key usage extension is present in the certificate, then interpersonal message S/&#8288;MIME receiving agents MUST check that it contains either the emailProtection or the anyExtendedKeyUsage OID as defined in <a href="#RFC5280">[RFC5280]</a>.  S/&#8288;MIME uses other than interpersonal messaging MAY require the explicit presence of the extended key usage extension or other OIDs to be present in the extension or both.  </p>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> Security Considerations</h1>
<p id="rfc.section.5.p.1">All of the security issues faced by any cryptographic application must be faced by a S/&#8288;MIME agent.  Among these issues are protecting the user's private key, preventing various attacks, and helping the user avoid mistakes such as inadvertently encrypting a message for the wrong recipient.  The entire list of security considerations is beyond the scope of this document, but some significant concerns are listed here.  </p>
<p id="rfc.section.5.p.2">When processing certificates, there are many situations where the processing might fail.  Because the processing may be done by a user agent, a security gateway, or other program, there is no single way to handle such failures.  Just because the methods to handle the failures have not been listed, however, the reader should not assume that they are not important.  The opposite is true: if a certificate is not provably valid and associated with the message, the processing software should take immediate and noticeable steps to inform the end user about it.  </p>
<p id="rfc.section.5.p.3">Some of the many places where signature and certificate checking might fail include: </p>

<ul>
  <li>no Internet mail addresses in a certificate match the sender of a message, if the certificate contains at least one mail address</li>
  <li>no certificate chain leads to a trusted CA</li>
  <li>no ability to check the CRL for a certificate</li>
  <li>an invalid CRL was received</li>
  <li>the CRL being checked is expired</li>
  <li>the certificate is expired</li>
  <li>the certificate has been revoked</li>
</ul>

<p> </p>
<p id="rfc.section.5.p.4">There are certainly other instances where a certificate may be invalid, and it is the responsibility of the processing software to check them all thoroughly, and to decide what to do if the check fails.  </p>
<p id="rfc.section.5.p.5">It is possible for there to be multiple unexpired CRLs for a CA.  If an agent is consulting CRLs for certificate validation, it SHOULD make sure that the most recently issued CRL for that CA is consulted, since an S/&#8288;MIME message sender could deliberately include an older unexpired CRL in an S/&#8288;MIME message.  This older CRL might not include recently revoked certificates, which might lead an agent to accept a certificate that has been revoked in a subsequent CRL.  </p>
<p id="rfc.section.5.p.6">When determining the time for a certificate validity check, agents have to be careful to use a reliable time.  Unless it is from a trusted agent, this time MUST NOT be the SigningTime attribute found in an S/&#8288;MIME message.  For most sending agents, the SigningTime attribute could be deliberately set to direct the receiving agent to check a CRL that could have out-of-date revocation status for a certificate, or cause an improper result when checking the Validity field of a certificate.  </p>
<p id="rfc.section.5.p.7">In addition to the Security Considerations identified in <a href="#RFC5280">[RFC5280]</a>, caution should be taken when processing certificates that have not first been validated to a trust anchor.  Certificates could be manufactured by untrusted sources for the purpose of mounting denial of service or other attacks.  For example, keys selected to require excessive cryptographic processing, or extensive lists of CRL Distribution Point (CDP) and/or Authority Information Access (AIA) addresses in the certificate, could be used to mount denial-of- service attacks.  Similarly, attacker-specified CDP and/or AIA addresses could be included in fake certificates to allow the originator to detect receipt of the message even if signature verification fails.  </p>
<p id="rfc.section.5.p.8">The 4096-bit RSA key size requirement for certificate and CRL verification is larger than the 2048-bit RSA key sizes for message signature generation/verification or message encryption/decryption in <a href="#RFC5751">[RFC5751]</a> because many root CAs included in certificate stores have already issued root certificates with the 4096-bit key.  The standard that defines comparable key sizes for DSA is not yet available.  In particular, <a href="#FIPS186-2">[FIPS186-2]</a> without Change Notice 1 allowed DSA key sizes between 512 and 1024 bits, <a href="#FIPS186-2">[FIPS186-2]</a> with Change Notice 1 only allowed DSA key sizes of 1024 bits, and <a href="#FIPS186-3">[FIPS186-3]</a> allowed DSA key sizes from 1024 to 3072 bits.  Further, 4096-bit keys are normally only used by Root certificates and not by subordinate CA certificates, thereby lengthening the root CA certificate's validity period.  </p>
<p id="rfc.section.5.p.9">RSA and DSA keys of less than 1024 bits are now considered by many experts to be cryptographically insecure (due to advances in computing power), and should no longer be used to sign certificates or CRLs.  Such keys were previously considered secure, so processing previously received signed and encrypted mail may require processing certificates or CRLs signed with weak keys.  Implementations that wish to support previous versions of S/&#8288;MIME or process old messages need to consider the security risks that result from accepting certificates and CRLs with smaller key sizes (e.g., spoofed certificates) versus the costs of denial of service.  If an implementation supports verification of certificates or CRLs generated with RSA and DSA keys of less than 1024 bits, it MUST warn the user.  Implementers should consider providing a stronger warning for weak signatures on certificates and CRLs associated with newly received messages than the one provided for certificates and CRLs associated with previously stored messages.  Server implementations (e.g., secure mail list servers) where user warnings are not appropriate SHOULD reject messages with weak cryptography.  </p>
<p id="rfc.section.5.p.10">If an implementation is concerned about compliance with National Institute of Standards and Technology (NIST) key size recommendations, then see <a href="#SP800-57">[SP800-57]</a>.  </p>
<h1 id="rfc.references"><a href="#rfc.references">6.</a> References</h1>
<h1 id="rfc.references.1"><a href="#rfc.references.1">6.1.</a> Normative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="FIPS186-2">[FIPS186-2]</b>
      </td>
      <td class="top"><a>National Institute of Standards and Technology (NIST)</a>, "<a>Digital Signature Standard (DSS) [With Change Notice 1]</a>", Federal Information Processing Standards Publication 186-2, January 2000.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="FIPS186-3">[FIPS186-3]</b>
      </td>
      <td class="top"><a>National Institute of Standards and Technology (NIST)</a>, <a>Digital Signature Standard (DSS)</a>", Federal Information Processing Standards Publication 186-3, June 2009.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2119">[RFC2119]</b>
      </td>
      <td class="top"><a>Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2634">[RFC2634]</b>
      </td>
      <td class="top"><a>Hoffman, P.</a>, "<a href="http://tools.ietf.org/html/rfc2634">Enhanced Security Services for S/MIME</a>", RFC 2634, DOI 10.17487/RFC2634, June 1999.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2985">[RFC2985]</b>
      </td>
      <td class="top"><a>Nystrom, M.</a> and <a>B. Kaliski</a>, "<a href="http://tools.ietf.org/html/rfc2985">PKCS #9: Selected Object Classes and Attribute Types Version 2.0</a>", RFC 2985, DOI 10.17487/RFC2985, November 2000.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC3279">[RFC3279]</b>
      </td>
      <td class="top"><a>Bassham, L.</a>, <a>Polk, W.</a> and <a>R. Housley</a>, "<a href="http://tools.ietf.org/html/rfc3279">Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 3279, DOI 10.17487/RFC3279, April 2002.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC3447">[RFC3447]</b>
      </td>
      <td class="top"><a>Jonsson, J.</a> and <a>B. Kaliski</a>, "<a href="http://tools.ietf.org/html/rfc3447">Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1</a>", RFC 3447, DOI 10.17487/RFC3447, February 2003.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC4055">[RFC4055]</b>
      </td>
      <td class="top"><a>Schaad, J.</a>, <a>Kaliski, B.</a> and <a>R. Housley</a>, "<a href="http://tools.ietf.org/html/rfc4055">Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 4055, DOI 10.17487/RFC4055, June 2005.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC4056">[RFC4056]</b>
      </td>
      <td class="top"><a>Schaad, J.</a>, "<a href="http://tools.ietf.org/html/rfc4056">Use of the RSASSA-PSS Signature Algorithm in Cryptographic Message Syntax (CMS)</a>", RFC 4056, DOI 10.17487/RFC4056, June 2005.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5035">[RFC5035]</b>
      </td>
      <td class="top"><a>Schaad, J.</a>, "<a href="http://tools.ietf.org/html/rfc5035">Enhanced Security Services (ESS) Update: Adding CertID Algorithm Agility</a>", RFC 5035, DOI 10.17487/RFC5035, August 2007.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5280">[RFC5280]</b>
      </td>
      <td class="top"><a>Cooper, D.</a>, <a>Santesson, S.</a>, <a>Farrell, S.</a>, <a>Boeyen, S.</a>, <a>Housley, R.</a> and <a>W. Polk</a>, "<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 5280, DOI 10.17487/RFC5280, May 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5652">[RFC5652]</b>
      </td>
      <td class="top"><a>Housley, R.</a>, "<a href="http://tools.ietf.org/html/rfc5652">Cryptographic Message Syntax (CMS)</a>", STD 70, RFC 5652, DOI 10.17487/RFC5652, September 2009.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5751">[RFC5751]</b>
      </td>
      <td class="top"><a>Ramsdell, B.</a> and <a>S. Turner</a>, "<a href="http://tools.ietf.org/html/rfc5751">Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.2 Message Specification</a>", RFC 5751, DOI 10.17487/RFC5751, January 2010.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5755">[RFC5755]</b>
      </td>
      <td class="top"><a>Farrell, S.</a>, <a>Housley, R.</a> and <a>S. Turner</a>, "<a href="http://tools.ietf.org/html/rfc5755">An Internet Attribute Certificate Profile for Authorization</a>", RFC 5755, DOI 10.17487/RFC5755, January 2010.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5758">[RFC5758]</b>
      </td>
      <td class="top"><a>Dang, Q.</a>, <a>Santesson, S.</a>, <a>Moriarty, K.</a>, <a>Brown, D.</a> and <a>T. Polk</a>, "<a href="http://tools.ietf.org/html/rfc5758">Internet X.509 Public Key Infrastructure: Additional Algorithms and Identifiers for DSA and ECDSA</a>", RFC 5758, DOI 10.17487/RFC5758, January 2010.</td>
    </tr>
    <tr><td class="reference"><b id="X.680">[X.680]</b></td><td class="top"><a>Information Technology - Abstract Syntax Notation One (ASN.1):  Specification of basic notation.  ITU-T Recommendation X.680 (2002) | ISO/IEC 8824-1:2002.</a>"</td>, "</tr>
  </tbody>
</table>
<h1 id="rfc.references.2"><a href="#rfc.references.2">6.2.</a> Informational References</h1>
<table>
  <tbody>
    <tr><td class="reference"><b id="ESS">[ESS]</b></td><td class="top"><a>Enhanced Security Services for S/ MIME</a>"<p>This is the set of documents dealing with enhanged security services and refers to </p></td>, "</tr>
    <tr>
      <td class="reference">
        <b id="PKCS6">[PKCS6]</b>
      </td>
      <td class="top"><a>RSA Laboratories</a>, "<a>PKCS #6: Extended-Certificate Syntax Standard</a>", November 1993.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2311">[RFC2311]</b>
      </td>
      <td class="top"><a>Dusse, S.</a>, <a>Hoffman, P.</a>, <a>Ramsdell, B.</a>, <a>Lundblade, L.</a> and <a>L. Repka</a>, "<a href="http://tools.ietf.org/html/rfc2311">S/MIME Version 2 Message Specification</a>", RFC 2311, DOI 10.17487/RFC2311, March 1998.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2312">[RFC2312]</b>
      </td>
      <td class="top"><a>Dusse, S.</a>, <a>Hoffman, P.</a>, <a>Ramsdell, B.</a> and <a>J. Weinstein</a>, "<a href="http://tools.ietf.org/html/rfc2312">S/MIME Version 2 Certificate Handling</a>", RFC 2312, DOI 10.17487/RFC2312, March 1998.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2313">[RFC2313]</b>
      </td>
      <td class="top"><a>Kaliski, B.</a>, "<a href="http://tools.ietf.org/html/rfc2313">PKCS #1: RSA Encryption Version 1.5</a>", RFC 2313, DOI 10.17487/RFC2313, March 1998.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2314">[RFC2314]</b>
      </td>
      <td class="top"><a>Kaliski, B.</a>, "<a href="http://tools.ietf.org/html/rfc2314">PKCS #10: Certification Request Syntax Version 1.5</a>", RFC 2314, DOI 10.17487/RFC2314, March 1998.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2315">[RFC2315]</b>
      </td>
      <td class="top"><a>Kaliski, B.</a>, "<a href="http://tools.ietf.org/html/rfc2315">PKCS #7: Cryptographic Message Syntax Version 1.5</a>", RFC 2315, DOI 10.17487/RFC2315, March 1998.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2630">[RFC2630]</b>
      </td>
      <td class="top"><a>Housley, R.</a>, "<a href="http://tools.ietf.org/html/rfc2630">Cryptographic Message Syntax</a>", RFC 2630, DOI 10.17487/RFC2630, June 1999.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2631">[RFC2631]</b>
      </td>
      <td class="top"><a>Rescorla, E.</a>, "<a href="http://tools.ietf.org/html/rfc2631">Diffie-Hellman Key Agreement Method</a>", RFC 2631, DOI 10.17487/RFC2631, June 1999.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2632">[RFC2632]</b>
      </td>
      <td class="top"><a>Ramsdell, B.</a>, "<a href="http://tools.ietf.org/html/rfc2632">S/MIME Version 3 Certificate Handling</a>", RFC 2632, DOI 10.17487/RFC2632, June 1999.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2633">[RFC2633]</b>
      </td>
      <td class="top"><a>Ramsdell, B.</a>, "<a href="http://tools.ietf.org/html/rfc2633">S/MIME Version 3 Message Specification</a>", RFC 2633, DOI 10.17487/RFC2633, June 1999.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC3114">[RFC3114]</b>
      </td>
      <td class="top"><a>Nicolls, W.</a>, <a href="http://tools.ietf.org/html/rfc3114">Implementing Company Classification Policy with the S/MIME Security Label</a>", RFC 3114, DOI 10.17487/RFC3114, May 2002.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC3850">[RFC3850]</b>
      </td>
      <td class="top"><a>Ramsdell, B.</a>, "<a href="http://tools.ietf.org/html/rfc3850">Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.1 Certificate Handling</a>", RFC 3850, DOI 10.17487/RFC3850, July 2004.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC3851">[RFC3851]</b>
      </td>
      <td class="top"><a>Ramsdell, B.</a>, "<a href="http://tools.ietf.org/html/rfc3851">Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.1 Message Specification</a>", RFC 3851, DOI 10.17487/RFC3851, July 2004.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC3852">[RFC3852]</b>
      </td>
      <td class="top"><a>Housley, R.</a>, "<a href="http://tools.ietf.org/html/rfc3852">Cryptographic Message Syntax (CMS)</a>", RFC 3852, DOI 10.17487/RFC3852, July 2004.</td>
    </tr>
    <tr><td class="reference"><b id="SMIMEv2">[SMIMEv2]</b></td><td class="top"><a>S/MIME version v2</a>"<p>This group of documents represents S/MIME version 2.  This set of documents are </p></td>, "</tr>
    <tr><td class="reference"><b id="SMIMEv3">[SMIMEv3]</b></td><td class="top"><a>S/MIME version 3</a>"<p>This group of documents represents S/MIME version 3.  This set of documents are </p></td>, "</tr>
    <tr><td class="reference"><b id="SMIMEv3.1">[SMIMEv3.1]</b></td><td class="top"><a>S/MIME version 3.1</a>"<p>This group of documents represents S/MIME version 3.1.  This set of documents are </p></td>, "</tr>
    <tr>
      <td class="reference">
        <b id="SP800-57">[SP800-57]</b>
      </td>
      <td class="top"><a>National Institute of Standards and Technology (NIST)</a>, <a>Special Publication 800-57: Recommendation for Key Management</a>", August 2005.</td>
    </tr>
    <tr><td class="reference"><b id="X.500">[X.500]</b></td><td class="top"><a>ITU-T Recommendation X.500 (1997) | ISO/IEC 9594- 1:1997, Information technology - Open Systems Interconnection - The Directory:  Overview of concepts, models and services.</a>"</td>, "</tr>
  </tbody>
</table>
<h1 id="rfc.appendix.A"><a href="#rfc.appendix.A">Appendix A.</a> Moving S/MIME v2 Certificate Handling to Historic Status</h1>
<p id="rfc.section.A.p.1">The S/&#8288;MIME v3 <a href="#SMIMEv3">[SMIMEv3]</a>, v3.1 <a href="#SMIMEv3.1">[SMIMEv3.1]</a>, and v3.2 (this document) are backwards compatible with the S/&#8288;MIME v2 Certificate Handling Specification <a href="#SMIMEv2">[SMIMEv2]</a>, with the exception of the algorithms (dropped RC2/40 requirement and added DSA and RSASSA-PSS requirements).  Therefore, it is recommended that RFC 2312 <a href="#SMIMEv2">[SMIMEv2]</a> be moved to Historic status.  </p>
<h1 id="rfc.appendix.B"><a href="#rfc.appendix.B">Appendix B.</a> Acknowledgments</h1>
<p id="rfc.section.B.p.1">Many thanks go out to the other authors of the S/&#8288;MIME v2 RFC: Steve Dusse, Paul Hoffman, and Jeff Weinstein.  Without v2, there wouldn't be a v3, v3.1, or v3.2.  </p>
<p id="rfc.section.B.p.2">A number of the members of the S/&#8288;MIME Working Group have also worked very hard and contributed to this document.  Any list of people is doomed to omission, and for that I apologize.  In alphabetical order, the following people stand out in my mind because they made direct contributions to this document.  </p>
<p id="rfc.section.B.p.3">Bill Flanigan, Trevor Freeman, Elliott Ginsburg, Alfred Hoenes, Paul Hoffman, Russ Housley, David P. Kemp, Michael Myers, John Pawling, Denis Pinkas, and Jim Schaad.  </p>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Authors' Addresses</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Jim Schaad</span> 
	  <span class="n hidden">
		<span class="family-name">Schaad</span>
	  </span>
	</span>
	<span class="org vcardline">August Cellars</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ietf@augustcellars.com">ietf@augustcellars.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Blake Ramsdell</span> 
	  <span class="n hidden">
		<span class="family-name">Ramsdell</span>
	  </span>
	</span>
	<span class="org vcardline">Brute Squad Labs, Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:blaker@gmail.com">blaker@gmail.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Sean Turner</span> 
	  <span class="n hidden">
		<span class="family-name">Turner</span>
	  </span>
	</span>
	<span class="org vcardline">sn3rd</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:sean@sn3rd.com">sean@sn3rd.com</a></span>

  </address>
</div>

  <div class="github-fork-ribbon-wrapper"><div class="github-fork-ribbon"><a href="https://github.com/spasm-wg/smime">Fork me on GitHub</a></div></div>
</body>
</html>
